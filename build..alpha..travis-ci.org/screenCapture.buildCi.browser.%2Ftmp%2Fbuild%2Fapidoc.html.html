<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/carlos8f/buffet">buffet (v1.0.10)</a>
</h1>
<h4>Static file server with in-memory cache</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet">module buffet</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet">
            function <span class="apidocSignatureSpan">buffet.</span>Buffet
            <span class="apidocSignatureSpan">(specs, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.super_">
            function <span class="apidocSignatureSpan">buffet.</span>Buffet.super_
            <span class="apidocSignatureSpan">(specs, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan"></span>buffet</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>Buffet.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>Buffet.super_.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>buffet_server</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>ecstatic</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>nginx</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>node_static</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>paperboy</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>send</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>st</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">buffet.</span>varnish</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.Buffet">module buffet.Buffet</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.Buffet">
            function <span class="apidocSignatureSpan">buffet.</span>Buffet
            <span class="apidocSignatureSpan">(specs, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.super_">
            function <span class="apidocSignatureSpan">buffet.Buffet.</span>super_
            <span class="apidocSignatureSpan">(specs, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.Buffet.prototype">module buffet.Buffet.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.prototype.middleware">
            function <span class="apidocSignatureSpan">buffet.Buffet.prototype.</span>middleware
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.Buffet.super_">module buffet.Buffet.super_</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.super_.super_">
            function <span class="apidocSignatureSpan">buffet.Buffet.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.Buffet.super_.prototype">module buffet.Buffet.super_.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.super_.prototype.close">
            function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.super_.prototype.compile">
            function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>compile
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.super_.prototype.files">
            function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>files
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.super_.prototype.get">
            function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>get
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.super_.prototype.getPlugin">
            function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>getPlugin
            <span class="apidocSignatureSpan">(p, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.Buffet.super_.prototype.makePluginPath">
            function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>makePluginPath
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.buffet">module buffet.buffet</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.buffet.middleware">
            function <span class="apidocSignatureSpan">buffet.buffet.</span>middleware
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">buffet.buffet.</span>version</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.buffet_server">module buffet.buffet_server</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.buffet_server.close">
            function <span class="apidocSignatureSpan">buffet.buffet_server.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.buffet_server.listen">
            function <span class="apidocSignatureSpan">buffet.buffet_server.</span>listen
            <span class="apidocSignatureSpan">(options, cb)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">buffet.buffet_server.</span>version</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.ecstatic">module buffet.ecstatic</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.ecstatic.middleware">
            function <span class="apidocSignatureSpan">buffet.ecstatic.</span>middleware
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.nginx">module buffet.nginx</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.nginx.close">
            function <span class="apidocSignatureSpan">buffet.nginx.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.nginx.listen">
            function <span class="apidocSignatureSpan">buffet.nginx.</span>listen
            <span class="apidocSignatureSpan">(options, cb)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">buffet.nginx.</span>name</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">buffet.nginx.</span>version</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.node_static">module buffet.node_static</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.node_static.middleware">
            function <span class="apidocSignatureSpan">buffet.node_static.</span>middleware
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.paperboy">module buffet.paperboy</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.paperboy.middleware">
            function <span class="apidocSignatureSpan">buffet.paperboy.</span>middleware
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.send">module buffet.send</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.send.middleware">
            function <span class="apidocSignatureSpan">buffet.send.</span>middleware
            <span class="apidocSignatureSpan">(options, cb)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.st">module buffet.st</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.st.middleware">
            function <span class="apidocSignatureSpan">buffet.st.</span>middleware
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.buffet.varnish">module buffet.varnish</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.varnish.close">
            function <span class="apidocSignatureSpan">buffet.varnish.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.buffet.varnish.listen">
            function <span class="apidocSignatureSpan">buffet.varnish.</span>listen
            <span class="apidocSignatureSpan">(options, cb)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">buffet.varnish.</span>name</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet" id="apidoc.module.buffet">module buffet</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.Buffet" id="apidoc.element.buffet.Buffet">
        function <span class="apidocSignatureSpan">buffet.</span>Buffet
        <span class="apidocSignatureSpan">(specs, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Buffet(specs, options) {
  if (toString.call(specs) === '[object Object]') {
    options = specs;
    specs = null;
  }
  if (!specs) specs = 'public/**/*';
  Mayonnaise.call(this, specs, options);
  this.on('all', function (op, file) {
    switch (op) {
      case 'add': case 'update': case 'cleanup':
        dish.clearCache(file.fullPath);
        break;
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.Buffet.super_" id="apidoc.element.buffet.Buffet.super_">
        function <span class="apidocSignatureSpan">buffet.</span>Buffet.super_
        <span class="apidocSignatureSpan">(specs, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Mayonnaise(specs, options) {
  if (specs &amp;&amp; toString.call(specs) === '[object Object]') {
    options = specs;
    specs = '.';
  }
  options || (options = {});
  this.options = options;
  EventEmitter.call(this);
  this.setMaxListeners(0);
  var self = this;
  this.pluginLookup = {};
  this.ready = false;

  // magic
  if (!Array.isArray(specs)) specs = [specs];

  var latch = specs.length;
  this.dollops = specs.map(function (spec, idx) {
    var opts = {cwd: spec.cwd};
    Object.keys(options).forEach(function (k) {
      if (k !== 'cwd') opts[k] = options[k];
    });
    return dollop(spec.globs || spec, opts)
      .on('all', function (op, file) {
        switch (op) {
          case 'add':
            if (file.stat.isFile()) {
              file.pluginPath = self.makePluginPath(file);
              if (typeof self.pluginLookup[file.pluginPath] === 'undefined') {
                self.pluginLookup[file.pluginPath] = [];
              }
              if (!~self.pluginLookup[file.pluginPath].indexOf(file)) {
                self.pluginLookup[file.pluginPath].push(file);
              }
            }
            file.weight = idx;
          case 'update':
            file.plugin = self.compile(file);
            break;
          case 'remove':
            break;
          case 'reset':
            // @todo: how to handle this
            //self.ready = false;
            //self.latch++;
            return;
          case 'ready':
            if (!self.ready &amp;&amp; !--latch) {
              self.ready = true;
              self.emit('ready', self.files());
            }
            return;
          default: return;
        }
        self.emit(op, file);
        self.emit('all', op, file);
      })
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>
























</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.Buffet" id="apidoc.module.buffet.Buffet">module buffet.Buffet</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.Buffet.Buffet" id="apidoc.element.buffet.Buffet.Buffet">
        function <span class="apidocSignatureSpan">buffet.</span>Buffet
        <span class="apidocSignatureSpan">(specs, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Buffet(specs, options) {
  if (toString.call(specs) === '[object Object]') {
    options = specs;
    specs = null;
  }
  if (!specs) specs = 'public/**/*';
  Mayonnaise.call(this, specs, options);
  this.on('all', function (op, file) {
    switch (op) {
      case 'add': case 'update': case 'cleanup':
        dish.clearCache(file.fullPath);
        break;
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.Buffet.super_" id="apidoc.element.buffet.Buffet.super_">
        function <span class="apidocSignatureSpan">buffet.Buffet.</span>super_
        <span class="apidocSignatureSpan">(specs, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Mayonnaise(specs, options) {
  if (specs &amp;&amp; toString.call(specs) === '[object Object]') {
    options = specs;
    specs = '.';
  }
  options || (options = {});
  this.options = options;
  EventEmitter.call(this);
  this.setMaxListeners(0);
  var self = this;
  this.pluginLookup = {};
  this.ready = false;

  // magic
  if (!Array.isArray(specs)) specs = [specs];

  var latch = specs.length;
  this.dollops = specs.map(function (spec, idx) {
    var opts = {cwd: spec.cwd};
    Object.keys(options).forEach(function (k) {
      if (k !== 'cwd') opts[k] = options[k];
    });
    return dollop(spec.globs || spec, opts)
      .on('all', function (op, file) {
        switch (op) {
          case 'add':
            if (file.stat.isFile()) {
              file.pluginPath = self.makePluginPath(file);
              if (typeof self.pluginLookup[file.pluginPath] === 'undefined') {
                self.pluginLookup[file.pluginPath] = [];
              }
              if (!~self.pluginLookup[file.pluginPath].indexOf(file)) {
                self.pluginLookup[file.pluginPath].push(file);
              }
            }
            file.weight = idx;
          case 'update':
            file.plugin = self.compile(file);
            break;
          case 'remove':
            break;
          case 'reset':
            // @todo: how to handle this
            //self.ready = false;
            //self.latch++;
            return;
          case 'ready':
            if (!self.ready &amp;&amp; !--latch) {
              self.ready = true;
              self.emit('ready', self.files());
            }
            return;
          default: return;
        }
        self.emit(op, file);
        self.emit('all', op, file);
      })
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.Buffet.prototype" id="apidoc.module.buffet.Buffet.prototype">module buffet.Buffet.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.Buffet.prototype.middleware" id="apidoc.element.buffet.Buffet.prototype.middleware">
        function <span class="apidocSignatureSpan">buffet.Buffet.prototype.</span>middleware
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (options) {
  var self = this;
  options || (options = {});
  options.defaultContentType = options.defaultContentType || 'application/octet-stream';
  if (typeof options.maxAge === 'undefined') options.maxAge = 300;
  options.index || (options.index = 'index.html');
  options.notFoundPath || (options.notFoundPath = '/404.html');
  if (options.notFoundPath[0] !== '/') {
    options.notFoundPath = '/' + options.notFoundPath;
  }

  var mw = function (req, res, next) {
    if (!next) next = function () {
      mw.notFound(req, res);
    };
    if (req.method.match(/^get|head$/i)) {
      // check for static file
      if (self.ready) checkCache();
      else {
        self.once('ready', checkCache);
      }
    }
    else next();

    function checkCache () {
      var urlPath = parsedUrls[req.url];
      if (!urlPath) {
        urlPath = parseUrl(req.url).pathname;
        // Decode and strip nullbytes for security
        try {
          urlPath = decodeURIComponent(urlPath).replace(/\0/g, '');
        }
        catch (err) {
          return next();
        }
        parsedUrls[req.url] = urlPath;
      }
      var file = self.get(urlPath);
      if (file &amp;&amp; file.stat.isFile()) return dish.file(file.fullPath, options)(req, res, next);
      if (options.index) {
        if (urlPath !== '/') urlPath += '/';
        urlPath += options.index;
        file = self.get(urlPath);
        if (file) return dish.file(file.fullPath, options)(req, res, next);
      }
      next();
    }
  };
  mw.notFound = function (req, res, next) {
    if (req.method !== 'GET' &amp;&amp; req.method !== 'HEAD') {
      res.writeHead(405, {'Content-Type': 'text/plain; charset=utf-8'});
      res.end('Method not allowed\n');
    }
    else {
      if (options.notFoundPath) {
        var cached = self.get(options.notFoundPath);
        if (cached) dish.file(cached.fullPath, {status: 404})(req, res, next);
        else default404();
      }
      else default404();

      function default404 () {
        res.writeHead(404, {'Content-Type': 'text/plain; charset=utf-8'});
        res.end('Page not found\n');
        return;
      }
    }
  };
  return mw;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (!root) {
    try {
      var stat = fs.statSync('public');
      root = path.resolve('public');
    }
    catch (e) {}
  }
  return new Buffet([{globs: '**/*', cwd: root}], options).<span class="apidocCodeKeywordSpan">middleware</span>(options
);
};

module.exports.Buffet = Buffet;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.Buffet.super_" id="apidoc.module.buffet.Buffet.super_">module buffet.Buffet.super_</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.Buffet.super_.super_" id="apidoc.element.buffet.Buffet.super_.super_">
        function <span class="apidocSignatureSpan">buffet.Buffet.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.Buffet.super_.prototype" id="apidoc.module.buffet.Buffet.super_.prototype">module buffet.Buffet.super_.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.Buffet.super_.prototype.close" id="apidoc.element.buffet.Buffet.super_.prototype.close">
        function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  this.dollops.forEach(function (d) {
    d.close();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.Buffet.super_.prototype.compile" id="apidoc.element.buffet.Buffet.super_.prototype.compile">
        function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>compile
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">compile = function (file) {
  // override this method
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.Buffet.super_.prototype.files" id="apidoc.element.buffet.Buffet.super_.prototype.files">
        function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>files
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">files = function () {
  return this.dollops.reduce(function (prev, d) {
    return prev.concat(d.files());
  }, []);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.Buffet.super_.prototype.get" id="apidoc.element.buffet.Buffet.super_.prototype.get">
        function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>get
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (key, options) {
  options || (options = {});
  var self = this;
  var files = this.dollops.reduce(function (prev, d) {
    var file = d.get(key);
    if (file) prev.push(file);
    return prev;
  }, []);
  if (options.priority === 'first') files.reverse();
  if (options.merge) {
    var ret;
    files.forEach(function (file) {
      if (ret) ret = options.merge(ret, file);
      else ret = file;
    });
    return ret;
  }
  else return options.merge === 'first' ? files[0] : files[files.length - 1];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    urlPath = decodeURIComponent(urlPath).replace(/\0/g, '');
  }
  catch (err) {
    return next();
  }
  parsedUrls[req.url] = urlPath;
}
var file = self.<span class="apidocCodeKeywordSpan">get</span>(urlPath);
if (file &amp;&amp; file.stat.isFile()) return dish.file(file.fullPath, options)(req, res, next);
if (options.index) {
  if (urlPath !== '/') urlPath += '/';
  urlPath += options.index;
  file = self.get(urlPath);
  if (file) return dish.file(file.fullPath, options)(req, res, next);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.Buffet.super_.prototype.getPlugin" id="apidoc.element.buffet.Buffet.super_.prototype.getPlugin">
        function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>getPlugin
        <span class="apidocSignatureSpan">(p, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPlugin = function (p, options) {
  options || (options = {});
  var self = this, ret;
  var files = this.pluginLookup[p] || [];
  files = files.slice();
  if (options.priority === 'first') files.reverse();
  files.forEach(function (file) {
    if (options.merge) {
      var compiled = self.compile(file);
      if (typeof ret === 'undefined') ret = compiled;
      else ret = options.merge(ret, compiled);
    }
    else {
      if (!file.plugin) file.plugin = self.compile(file);
      ret = file;
    }
  });
  return ret;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.Buffet.super_.prototype.makePluginPath" id="apidoc.element.buffet.Buffet.super_.prototype.makePluginPath">
        function <span class="apidocSignatureSpan">buffet.Buffet.super_.prototype.</span>makePluginPath
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">makePluginPath = function (file) {
  return file.key.replace(/\.[^\.]+$/, '');
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.buffet" id="apidoc.module.buffet.buffet">module buffet.buffet</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.buffet.middleware" id="apidoc.element.buffet.buffet.middleware">
        function <span class="apidocSignatureSpan">buffet.buffet.</span>middleware
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (options) {
  return require('../')(options.root);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (!root) {
    try {
      var stat = fs.statSync('public');
      root = path.resolve('public');
    }
    catch (e) {}
  }
  return new Buffet([{globs: '**/*', cwd: root}], options).<span class="apidocCodeKeywordSpan">middleware</span>(options
);
};

module.exports.Buffet = Buffet;
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.buffet_server" id="apidoc.module.buffet.buffet_server">module buffet.buffet_server</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.buffet_server.close" id="apidoc.element.buffet.buffet_server.close">
        function <span class="apidocSignatureSpan">buffet.buffet_server.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  buffet.kill();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.buffet_server.listen" id="apidoc.element.buffet.buffet_server.listen">
        function <span class="apidocSignatureSpan">buffet.buffet_server.</span>listen
        <span class="apidocSignatureSpan">(options, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listen = function (options, cb) {
  var port = randomPort()

  buffet = execFile(buffetRoot + '/bin/buffet.js', ['-p', port, '--no-log', '--no-watch'], {cwd: options.root});
  buffet.stderr.on('data', function (chunk) {
    if (chunk.toString().match(/listening/)) {
      cb(null, port);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  , buffet = require('buffet')({root: './public'}) // root defaults to ./public

app.use(buffet);
// (non-static routes here)
app.use(buffet.notFound);

var server = require('http').createServer(app);
server.<span class="apidocCodeKeywordSpan">listen</span>(3000, function () {
  console.log('test server running on port 3000');
});
```

### Easy built-in server

```bash
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.ecstatic" id="apidoc.module.buffet.ecstatic">module buffet.ecstatic</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.ecstatic.middleware" id="apidoc.element.buffet.ecstatic.middleware">
        function <span class="apidocSignatureSpan">buffet.ecstatic.</span>middleware
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (options) {
  return require('ecstatic')(options.root, { cache: 7200 });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (!root) {
    try {
      var stat = fs.statSync('public');
      root = path.resolve('public');
    }
    catch (e) {}
  }
  return new Buffet([{globs: '**/*', cwd: root}], options).<span class="apidocCodeKeywordSpan">middleware</span>(options
);
};

module.exports.Buffet = Buffet;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.nginx" id="apidoc.module.buffet.nginx">module buffet.nginx</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.nginx.close" id="apidoc.element.buffet.nginx.close">
        function <span class="apidocSignatureSpan">buffet.nginx.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  exec('nginx', ['-s', 'quit']);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.nginx.listen" id="apidoc.element.buffet.nginx.listen">
        function <span class="apidocSignatureSpan">buffet.nginx.</span>listen
        <span class="apidocSignatureSpan">(options, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listen = function (options, cb) {
  exec('nginx', ['-c', join(__dirname, 'nginx', 'nginx.conf')]);
  setTimeout(function () {
    cb(null, 8080);
  }, 500);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  , buffet = require('buffet')({root: './public'}) // root defaults to ./public

app.use(buffet);
// (non-static routes here)
app.use(buffet.notFound);

var server = require('http').createServer(app);
server.<span class="apidocCodeKeywordSpan">listen</span>(3000, function () {
  console.log('test server running on port 3000');
});
```

### Easy built-in server

```bash
...</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.node_static" id="apidoc.module.buffet.node_static">module buffet.node_static</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.node_static.middleware" id="apidoc.element.buffet.node_static.middleware">
        function <span class="apidocSignatureSpan">buffet.node_static.</span>middleware
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (options) {
  var nodeStatic = require('node-static')
    , fileServer = new(nodeStatic.Server)(options.root, { cache: 7200 })

  return fileServer.serve.bind(fileServer);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (!root) {
    try {
      var stat = fs.statSync('public');
      root = path.resolve('public');
    }
    catch (e) {}
  }
  return new Buffet([{globs: '**/*', cwd: root}], options).<span class="apidocCodeKeywordSpan">middleware</span>(options
);
};

module.exports.Buffet = Buffet;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.paperboy" id="apidoc.module.buffet.paperboy">module buffet.paperboy</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.paperboy.middleware" id="apidoc.element.buffet.paperboy.middleware">
        function <span class="apidocSignatureSpan">buffet.paperboy.</span>middleware
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (options) {
  var paperboy = require('paperboy');
  return function (req, res, next) {
    paperboy.deliver(options.root, req, res);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (!root) {
    try {
      var stat = fs.statSync('public');
      root = path.resolve('public');
    }
    catch (e) {}
  }
  return new Buffet([{globs: '**/*', cwd: root}], options).<span class="apidocCodeKeywordSpan">middleware</span>(options
);
};

module.exports.Buffet = Buffet;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.send" id="apidoc.module.buffet.send">module buffet.send</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.send.middleware" id="apidoc.element.buffet.send.middleware">
        function <span class="apidocSignatureSpan">buffet.send.</span>middleware
        <span class="apidocSignatureSpan">(options, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (options, cb) {
  var send = require('send');
  return function (req, res, next) {
    send(req, req.url)
      .root(options.root)
      .pipe(res);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (!root) {
    try {
      var stat = fs.statSync('public');
      root = path.resolve('public');
    }
    catch (e) {}
  }
  return new Buffet([{globs: '**/*', cwd: root}], options).<span class="apidocCodeKeywordSpan">middleware</span>(options
);
};

module.exports.Buffet = Buffet;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.st" id="apidoc.module.buffet.st">module buffet.st</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.st.middleware" id="apidoc.element.buffet.st.middleware">
        function <span class="apidocSignatureSpan">buffet.st.</span>middleware
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">middleware = function (options) {
  return require('st')({
    path: options.root,
    url: '/',

    cache: {
      fd: {
        max: 1000, // number of fd's to hang on to
        maxAge: 1000*60*60, // amount of ms before fd's expire
      },

      stat: {
        max: 5000, // number of stat objects to hang on to
        maxAge: 1000 * 60, // number of ms that stats are good for
      },

      content: {
        max: 1024*1024*64, // how much memory to use on caching contents
        maxAge: 1000 * 60 * 10, // how long to cache contents for
      }
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (!root) {
    try {
      var stat = fs.statSync('public');
      root = path.resolve('public');
    }
    catch (e) {}
  }
  return new Buffet([{globs: '**/*', cwd: root}], options).<span class="apidocCodeKeywordSpan">middleware</span>(options
);
};

module.exports.Buffet = Buffet;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.buffet.varnish" id="apidoc.module.buffet.varnish">module buffet.varnish</a></h1>


    <h2>
        <a href="#apidoc.element.buffet.varnish.close" id="apidoc.element.buffet.varnish.close">
        function <span class="apidocSignatureSpan">buffet.varnish.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  varnish.kill();
  buffet.kill();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.buffet.varnish.listen" id="apidoc.element.buffet.varnish.listen">
        function <span class="apidocSignatureSpan">buffet.varnish.</span>listen
        <span class="apidocSignatureSpan">(options, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listen = function (options, cb) {
  var buffetPort = randomPort()
    , buffetRoot = require('path').resolve(__dirname, '..')
    , port = randomPort()

  buffet = execFile(buffetRoot + '/bin/buffet.js', ['-p', buffetPort], {cwd: options.root});

  varnish = spawn('varnishd', ['-F', '-n', require('idgen')(), '-s', 'malloc', '-b', '127.0.0.1:' + buffetPort, '-a', '127.0.0.1
:' + port]);
  varnish.stderr.on('data', function (chunk) {
    if (chunk.toString().match(/Child starts/)) {
      cb(null, port);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  , buffet = require('buffet')({root: './public'}) // root defaults to ./public

app.use(buffet);
// (non-static routes here)
app.use(buffet.notFound);

var server = require('http').createServer(app);
server.<span class="apidocCodeKeywordSpan">listen</span>(3000, function () {
  console.log('test server running on port 3000');
});
```

### Easy built-in server

```bash
...</pre></li>
    </ul>




</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>